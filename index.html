<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Survey of Boundary Indication</title>

    <style>
        body {
          background-color: Azure;
        }

        p {
          font-family: verdana;
          font-size: 16px;
        }
        a {
          border: 1px solid black;
          margin-top: 200px;
          margin-bottom: 100px;
          margin-right: 20px;
          margin-left: 20px;
          background-color: lightblue;
          font-size: 30px;
        }

        div.stopwatch {
          margin-left: 20px;
          font-size: 18px;
          left: 60%;
        }

        div {
          margin-top: 20px;
          margin-bottom: 20px;
          margin-right: 10px;
          margin-left: 20px;
          font-size: 16px;
        }

        button {
          display:inline-block;
          font-size:15px;
          width:9%;height:40px;
          margin:2%; color:white;
          font-weight:bolder;
          text-align: center;
          outline:none; border:0;
          border-radius:3px;
          background-color:FireBrick;
          box-shadow:0 1px 3px rgba(0,0,0,0.12), 0 3px 5px rgba(0,0,0,0.3);
          cursor:pointer ;
          outline:none;
          transition:0.1s;
        }

        a.button {
          display:inline-block;
          font-size:15px;
          width:9%;height:40px;
          margin:1.5%; color:white;
          font-weight:bolder;
          text-align: center;
          outline:none; border:0;
          border-radius:3px;
          background-color:teal;
          box-shadow:0 1px 3px rgba(0,0,0,0.12), 0 3px 5px rgba(0,0,0,0.3);
          cursor:pointer ;
          outline:none;
          transition:0.1s;
        }
    </style>

</head>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<body>


<div>
<h2>음악구조에 대한 인지 설문조사</h2>
<h5>안녕하세요. 본 설문은 음악 인지과학(GCT731) 수업 프로젝트에서 사람이 음악을 들을 때 어떻게 구조를 파악하는지 알아보기 위한 조사입니다.
        대략 10~15분 정도의 시간이 소요되며, 각 음악을 들으면서 <strong>한 파트가 마무리되고 다음 파트가 시작되는 경계 지점</strong>이라고 느끼실 때마다
    <strong>Lap 버튼</strong>을 눌러 시간을 기록해주시면 됩니다. 본 설문에는 정답이 없으며, 편안하게 음악을 들으며 응답해주시면 됩니다. 본 설문은 오직 연구 목적으로만 사용됩니다. </h5>
<h5>문의: KAIST 문화기술대학원 석사과정 김한라(kimhalla@kaist.ac.kr)</h5>
<br><br>

</div>


<!--Song 1-->



<form id="gform" method="POST"
    action="https://script.google.com/macros/s/AKfycbxz4qkKrGwFDylh5vtLep9ACrPSW7bO5bJgY9U6WQ/exec">
<ul class="results"></ul>

    <div>
    <p>성별:</p> <input type="radio" name="gender" value="male"> 남성<br> <input type="radio" name="gender" value="female"> 여성<br>
    <p>출생연도:</p> <input type="text" name="birth year">년<br>
    <p>소속/전공:</p> <input type="text" name="major"><br>
    <p>하루에 음악을 듣는 시간이 얼마나 되십니까?</p>
        <input type="radio" name="time of music listening" value="0-1"> 0~1시간<br>
        <input type="radio" name="time of music listening" value="1-2"> 1~2시간<br>
        <input type="radio" name="time of music listening" value="2-3"> 2~3시간<br>
        <input type="radio" name="time of music listening" value="3-"> 3시간 이상<br>
    <p>악기 연습이나 음악에 관한 공부를 하루에 몇 시간 동안 했었거나 하고 있습니까?</p>
        <input type="radio" name="time of music practicing" value="0-1"> 0~1시간<br>
        <input type="radio" name="time of music practicing" value="1-2"> 1~2시간<br>
        <input type="radio" name="time of music practicing" value="2-3"> 2~3시간<br>
        <input type="radio" name="time of music practicing" value="3-"> 3시간 이상<br>
    <br>

    </div>
</form>


<div class="w3-container w3-black">
    <p>Song 1</p>
</div>

<audio id="song1">
    <source src="FluffyClouds_mono.wav" type="audio/wav">
    Your browser does not support the audio element.
</audio>

<nav class="controls">
    <a href="#a" class="button" onClick="stopwatch1.start1();">시작</a>
    <a href="#a" class="button" onClick="stopwatch1.lap1();">기록</a>
    <a href="#a" class="button" onClick="stopwatch1.stop1();">일시 정지</a>
    <a href="#a" class="button" onClick="stopwatch1.restart1();">재시작</a>
    <a href="#a" class="button" onClick="stopwatch1.clear1();">기록 모두 지우기</a>
</nav>


<div>스톱워치: </div>
<div class="stopwatch1"></div>
<div>
    <p>응답 기록:</p> <p id="response of song 1"></p>
</div>


<form id="gform" method="POST"
    action="https://script.google.com/macros/s/AKfycbxz4qkKrGwFDylh5vtLep9ACrPSW7bO5bJgY9U6WQ/exec">
<ul class="results"></ul>
    <div>
    <input type="text" name="Boundary Indication of Song 1" id="lap1" value="0" size="30"><br>
    <br>
    </div>
</form>
<br>




<!--Song 2-->

<div class="w3-container w3-black">
    <p>Song 2</p>
</div>

<audio id="song2">
    <source src="horse.ogg" type="audio/ogg">
    Your browser does not support the audio element.
</audio>


<nav class="controls">
    <a href="#a" class="button" onClick="stopwatch2.start2();">시작</a>
    <a href="#a" class="button" onClick="stopwatch2.lap2();">기록</a>
    <a href="#a" class="button" onClick="stopwatch2.stop2();">일시 정지</a>
    <a href="#a" class="button" onClick="stopwatch2.restart2();">재시작</a>
    <a href="#a" class="button" onClick="stopwatch2.clear2();">기록 모두 지우기</a>
</nav>


<div>스톱워치: </div>
<div class="stopwatch2"></div>
<div>
    <p>응답 기록:</p> <p id="response of song 2"></p>
</div>


<form id="gform" method="POST"
    action="https://script.google.com/macros/s/AKfycbxz4qkKrGwFDylh5vtLep9ACrPSW7bO5bJgY9U6WQ/exec">
<ul class="results"></ul>
    <div>
    <input type="text" name="Boundary Indication of Song 2" id="lap2" value="0" size="70"><br>
    <br>
        <button type="submit" form="gform" value="Submit">Submit</button>
    </div>
</form>



<script>

    var song1 = document.getElementById("song1");
    var song2 = document.getElementById("song2");

    class Stopwatch {
    constructor(display, results) {
        this.running = false;
        this.display = display;
        this.results = results;
        this.laps = [];
        this.reset();
        this.print(this.times);
    }

    reset() {
        this.times = [ 0, 0, 0 ];
    }

    start1() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
            song1.play();
        }
    }

    start2() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
            song2.play();
        }
    }

    lap1() {
         let times = this.times;
         let input = document.getElementById("lap1");
         var lapInput = input.value;
         var lapInputByNow = lapInput.concat(" ; ", this.format(times));
         input.value = lapInputByNow;
         document.getElementById("response of song 1").innerHTML = lapInputByNow;
         this.results.appendChild(input);
         form.appendChild(input);


    }

    lap2() {
         let times = this.times;
         let input = document.getElementById("lap2");
         var lapInput = input.value;
         var lapInputByNow = lapInput.concat(" ; ", this.format(times));
         input.value = lapInputByNow;
         document.getElementById("response of song 2").innerHTML = lapInputByNow;
         this.results.appendChild(input);
         form.appendChild(input);
    }

    stop1() {
        this.running = false;
        this.time = null;
        song1.pause();
    }

    stop2() {
        this.running = false;
        this.time = null;
        song2.pause();
    }

    restart1() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
        }
        this.reset();
        song1.currentTime = 0;
        song1.play();
    }

    restart2() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
        }
        this.reset();
        song2.currentTime = 0;
        song2.play();
    }

    clear1() {
        let input = document.getElementById("lap1");
        input.value = 0;
        document.getElementById("response of song 1").innerHTML = " ";
        //clearChildren(this.results);
    }

    clear2() {
        let input = document.getElementById("lap2");
        input.value = 0;
        document.getElementById("response of song 2").innerHTML = " ";
        //clearChildren(this.results);
    }

    step(timestamp) {
        if (!this.running) return;
        this.calculate(timestamp);
        this.time = timestamp;
        this.print();
        requestAnimationFrame(this.step.bind(this));
    }

    calculate(timestamp) {
        var diff = timestamp - this.time;
        // Hundredths of a second are 100 ms
        this.times[2] += diff / 10;
        // Seconds are 100 hundredths of a second
        if (this.times[2] >= 100) {
            this.times[1] += 1;
            this.times[2] -= 100;
        }
        // Minutes are 60 seconds
        if (this.times[1] >= 60) {
            this.times[0] += 1;
            this.times[1] -= 60;
        }
    }

    print() {
        this.display.innerText = this.format(this.times);
    }

    format(times) {
        return `\
${pad0(times[0], 2)}:\
${pad0(times[1], 2)}:\
${pad0(Math.floor(times[2]), 2)}`;
    }
}

function pad0(value, count) {
    var result = value.toString();
    for (; result.length < count; --count)
        result = '0' + result;
    return result;
}

function clearChildren(node) {
    while (node.lastChild)
        node.removeChild(node.lastChild);
}

let stopwatch1 = new Stopwatch(
    document.querySelector('.stopwatch1'),
    document.querySelector('.results'));

let stopwatch2 = new Stopwatch(
    document.querySelector('.stopwatch2'),
    document.querySelector('.results'));


</script>






</body>
</html>